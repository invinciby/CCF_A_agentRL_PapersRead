# 年份选择功能说明

## 功能概述

现在Web界面支持在**2024年**和**2025年**的论文数据之间切换查看，用户可以轻松对比两年的论文分类结果。

## 使用方法

### 切换年份

1. **查看年份选择器**
   - 位置：页面顶部标题下方
   - 显示：📅 选择年份: [2025年] [2024年] 等按钮

2. **点击年份按钮**
   - 点击要查看的年份（如"2024年"）
   - 当前年份按钮会高亮显示（紫色背景）
   - 界面自动加载该年份的所有论文和分类

3. **查看数据**
   - 论文总数和分类数量会自动更新
   - 所有分类和搜索结果都会显示该年份的数据
   - 分页状态会自动重置

## UI 设计

### 年份选择器样式

```
┌─────────────────────────────────────────────┐
│ 📚 论文分类可视化与搜索                      │
│                                              │
│ 📅 选择年份: [2025年] [2024年] [2023年]      │
│            ↑ 活跃（紫色）    灰色（非活跃）│
│                                              │
│ 论文总数: 371        分类数量: 16             │
└─────────────────────────────────────────────┘
```

### 按钮状态

| 状态 | 外观 | 含义 |
|------|------|------|
| 活跃 | 紫色背景，白色文字 | 当前正在查看的年份 |
| 非活跃 | 灰色边框，黑色文字 | 其他可选的年份 |
| 悬停 | 紫色边框，紫色文字 | 鼠标悬停时的样式 |

## 工作流程

### 初始加载
```
页面打开
  ↓
获取可用年份列表
  ↓
渲染年份选择按钮
  ↓
加载最新年份的数据（如2025年）
  ↓
显示页面内容
```

### 切换年份
```
用户点击年份按钮
  ↓
显示"加载中..."
  ↓
调用API加载新年份数据
  ↓
更新所有页面内容
  ↓
重置分页和搜索状态
  ↓
隐藏"加载中..."，显示新数据
```

## 功能细节

### 自动重置

切换年份时，以下内容会自动重置：
- ✅ 搜索框清空
- ✅ 分页重置为第1页
- ✅ 分类状态重置为展开

### 数据更新

切换年份后自动更新：
- ✅ 论文总数统计
- ✅ 分类数量统计
- ✅ 所有分类内容
- ✅ 论文卡片信息

### 用户体验

- ✅ 点击已选中的年份无效果
- ✅ 加载中显示反馈
- ✅ 出错时显示错误提示
- ✅ 响应式设计适配各种屏幕

## API 接口

### 获取可用年份

```
GET /api/years

响应:
{
  "years": ["2025", "2024", "2023"],
  "current_year": "2025"
}
```

### 加载特定年份数据

```
POST /api/load-year/<year>

示例: POST /api/load-year/2024

响应（成功）:
{
  "success": true,
  "year": "2024",
  "message": "成功加载 2024 年的数据"
}

响应（失败）:
{
  "success": false,
  "year": "2024",
  "message": "加载 2024 年的数据失败"
}
```

## 目录结构

系统支持以下目录结构：

```
output/
├── 2025/
│   ├── keyword_timestamp1/
│   │   ├── 00_classification_summary.json
│   │   ├── 01_分类1.json
│   │   └── ...
│   └── keyword_timestamp2/
│       └── ...
├── 2024/
│   ├── keyword_timestamp/
│   │   ├── 00_classification_summary.json
│   │   ├── 01_分类1.json
│   │   └── ...
│   └── ...
└── 2023/
    └── ...
```

## 常见问题

### Q: 如何添加新的年份？
A: 在 `output` 目录下创建新的年份目录（如 `2023`），并将分类结果放入其中。重启应用会自动识别新年份。

### Q: 年份按钮的顺序是什么？
A: 按照降序排列，最新的年份在最前面。

### Q: 切换年份后搜索结果会保存吗？
A: 不会，为了避免混淆，切换年份时搜索框会自动清空。

### Q: 如果某个年份的数据不完整怎么办？
A: 会显示错误提示，请检查数据目录结构是否正确。

### Q: 可以同时查看多个年份的数据吗？
A: 不可以，当前只支持查看一个年份。如需对比，需要先后查看两个年份并手动记录。

## 技术实现

### 后端（Python）

`ClassificationVisualizer` 类新增方法：
- `get_available_years()` - 扫描output目录获取年份
- `load_year_data(year)` - 加载特定年份的数据

Flask新增路由：
- `/api/years` - 返回年份列表和当前年份
- `/api/load-year/<year>` - 加载年份数据的POST端点

### 前端（JavaScript）

新增函数：
- `loadYears()` - 获取年份列表
- `renderYearButtons()` - 渲染年份按钮
- `selectYear(year)` - 处理年份切换逻辑

## 样式自定义

### 修改年份按钮样式

编辑 `main.py` 中的CSS部分：

```css
.year-btn {
    padding: 10px 16px;              /* 调整按钮大小 */
    border: 2px solid #ddd;
    background: white;
    border-radius: 6px;
    /* ... */
}

.year-btn.active {
    background: #667eea;             /* 调整活跃颜色 */
    color: white;
    /* ... */
}
```

### 修改年份选择器布局

```css
.year-selector {
    margin-top: 20px;
    padding-top: 20px;
    display: flex;
    align-items: center;
    gap: 15px;
    /* 调整这些值以改变布局 */
}
```

## 性能考虑

- ✅ 年份数据按需加载，不会一次加载所有年份
- ✅ 切换年份时使用简单的API调用，响应快速
- ✅ 分页状态自动重置，避免内存泄漏
- ✅ 搜索状态自动清空，保持清洁

## 更新日志

### v2.3 (当前版本)
- ✨ 新增年份选择功能
- ✨ 支持2024/2025年数据切换
- 🎨 年份选择器UI设计
- 📝 年份相关文档

### v2.2
- 垂直滚动功能
- 分页导航系统

---

**现在可以轻松在多年数据之间切换！** 📅✨
